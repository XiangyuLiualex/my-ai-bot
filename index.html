<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>Coze 无状态 Chat SDK 测试</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 50px;
    }
  </style>
</head>
<body>
  <h1>Coze 无状态 Chat SDK 测试</h1>
  <p>本示例尝试使用海外版 Coze Chat SDK，并随机生成 <code>conversation_id</code> / <code>user_id</code>，避免历史共享。</p>

  <!-- 引入海外版 Chat SDK 脚本 -->
  <script src="https://sf-cdn.coze.com/obj/unpkg-va/flow-platform/chat-app-sdk/1.2.0-beta.5/libs/oversea/index.js"></script>
  <script>
    // 随机生成 ID 的小函数
    function randomId(prefix) {
      return prefix + '-' + Math.random().toString(36).substr(2, 9);
    }

    // 每次刷新页面时，生成新的会话ID & 用户ID
    const conversationId = randomId('conv');
    const userId = randomId('user');

    // 初始化 Coze Chat SDK
    const chatClient = new CozeWebSDK.WebChatClient({
      config: {
        // 这里请填入你在海外版 Coze 后台看到的 Bot ID
        bot_id: '7481792028402565175',

        // 使用随机的 conversation_id 和 user_id
        conversation_id: conversationId,
        user_id: userId,
      },
      componentProps: {
        // Chat SDK 右下角浮窗标题
        title: 'Coze 无状态测试',
      },
      auth: {
        // 使用 token 方式鉴权
        type: 'token',
        // 这里请替换成你的海外版 Coze Token
        token: 'pat_8cZrNUC6nDyy9FY3WCfGoRsQPFKM0kyQvb72HpctbbiE9yviITqEB02uiZIshoqP',
        onRefreshToken: () => 'pat_8cZrNUC6nDyy9FY3WCfGoRsQPFKM0kyQvb72HpctbbiE9yviITqEB02uiZIshoqP'
      }
    });

    // 重置会话，尝试清空任何默认加载的历史
    chatClient.resetConversation();
  </script>
</body>
</html>
